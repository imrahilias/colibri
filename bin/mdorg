#!/bin/sh

for f in "$@"
do
    path="$f"
    file="${path##*/}"
    mime="$(file --dereference --brief --mime-type -- "$f")"
    name="${file%%.*}" # shell escape
    ext="${file#*.}" # shell escape; "example.tar.gz" gives "tar.gz"
    echo $path $file $name $ext $mime
    if [[ $ext == "md" && $mime == "text/plain" ]]
    then # convert to org file and make the original hidden:
        #pandoc -f markdown -t org -o ${name}.org ${f} && mv ${name}.${ext} .${name}.${ext}
        pandoc -f markdown -t org ${f} | sed '/^:/ d' > ${name}.org && mv ${name}.${ext} .${name}.${ext}
    fi
done
